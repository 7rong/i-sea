"use strict";(self["webpackChunki_sea"]=self["webpackChunki_sea"]||[]).push([[43],{4226:function(t,s){s.Z={setFavorite(t){const s=JSON.stringify(t);localStorage.setItem("favoriteList",s)},getFavorite(){return JSON.parse(localStorage.getItem("favoriteList"))}}},4043:function(t,s,e){e.r(s),e.d(s,{default:function(){return bt}});var i=e(3396),a=e(7139),c=e(9242);const o={key:0,style:{"line-height":"50vh"},class:"text-center text-muted fw-bold"},r={key:1},d=["src"],l={key:1,id:"product-img",class:"carousel slide","data-bs-ride":"carousel"},n={class:"carousel-inner"},u={class:"carousel-item active","data-bs-interval":"3000"},p=["src"],h=["src"],g=(0,i.uE)('<button class="carousel-control-prev" type="button" data-bs-target="#product-img" data-bs-slide="prev"><span class="carousel-control-prev-icon" aria-hidden="true"></span><span class="visually-hidden">Previous</span></button><button class="carousel-control-next" type="button" data-bs-target="#product-img" data-bs-slide="next"><span class="carousel-control-next-icon" aria-hidden="true"></span><span class="visually-hidden">Next</span></button>',2),b={class:"container-fluid pb-3 pt-5 cus-bg-patterns"},m={class:"row justify-content-center"},v={class:"col-md-7 text-secondary"},y={class:"d-flex justify-content-between"},_={class:"mb-1"},w=(0,i._)("i",{class:"bi bi-suit-heart"},null,-1),f=[w],k={class:"text-muted"},x=(0,i._)("i",{class:"bi bi-geo-alt-fill"},null,-1),C={class:"pb-5 mt-3"},I={style:{"white-space":"pre-line"},class:"pb-5"},D=(0,i._)("p",{class:"border-top border-secondary pt-3 text-primary fw-bold mb-1"},"取消政策",-1),L=(0,i._)("ul",{class:"text-primary list-unstyled"},[(0,i._)("li",null,"＊ 所選日期 60 天（含）之前取消，收取手續費 0%"),(0,i._)("li",null,"＊ 所選日期 30-60 天之間取消，收取手續費 50%"),(0,i._)("li",null,"＊ 所選日期 0-30 天之間取消，收取手續費 100%")],-1),M={class:"col-md-3 position-relative"},z={class:"card text-center sticky-md-top mb-3 aside-pos"},$={class:"card-body"},q={key:0,class:"card-text h6 mb-0"},U={class:"text-primary h5"},S={key:1,class:"fs-6 text-muted ms-2"},j={key:2,class:"card-text h6 mb-0"},P={class:"text-danger h4"},F=(0,i._)("hr",null,null,-1),W={class:"row g-0"},H=["onClick"],Y={class:"col-12 mt-0 mb-2"},Z=(0,i._)("label",{for:"product_qty",class:"form-label w-100"},null,-1),K={class:"input-group my-auto"},N={class:"input-group-text",id:"number"},O={class:"col-12"},J=["disabled"],T=(0,i._)("span",{class:"pe-2"},"加入購物車",-1),E=(0,i._)("i",{class:"bi bi-cart"},null,-1),V=[T,E],A={key:1,type:"button",class:"btn btn-outline-light w-100"},B=(0,i._)("div",{class:"spinner-border spinner-border-sm text-white",role:"status"},[(0,i._)("span",{class:"visually-hidden"},"Loading...")],-1),G=[B],Q=(0,i._)("span",{class:"pe-4"},"前往購物車",-1),R=(0,i._)("i",{class:"bi bi-cart-check"},null,-1),X={key:2,class:"cus-bg-lighter"},tt={class:"container py-3"},st=(0,i._)("h3",{class:"text-primary h5 mb-3 ms-1"},"你可能喜歡",-1),et={class:"row row-cols-md-3 row-cols-1 gy-3"},it={class:"card h-100"},at={class:"card-body d-flex flex-column justify-content-between"},ct={class:"mb-3"},ot={class:"card-title text-primary mb-1"},rt={class:"text-muted"},dt=(0,i._)("i",{class:"bi bi-geo-alt-fill"},null,-1),lt={class:"card-text text-secondary mt-2"};function nt(t,s,e,w,T,E){const B=(0,i.up)("LoadingComp"),nt=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(B,{active:T.isLoading},null,8,["active"]),T.productCatch?((0,i.wg)(),(0,i.iD)("p",o,(0,a.zw)(T.productCatchMsg)+"，請稍後重試",1)):((0,i.wg)(),(0,i.iD)("div",r,[T.product.images?((0,i.wg)(),(0,i.iD)("div",l,[(0,i._)("div",n,[(0,i._)("div",u,[(0,i._)("img",{src:T.product.imgUrl,class:"d-block w-100",alt:"主圖",style:{"object-fit":"cover",height:"500px"}},null,8,p)]),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(T.product.images,(t=>((0,i.wg)(),(0,i.iD)("div",{class:"carousel-item","data-bs-interval":"3000",key:t},[(0,i._)("img",{src:t,class:"d-block w-100",alt:"圖片",style:{"object-fit":"cover",height:"500px"}},null,8,h)])))),128))]),g])):((0,i.wg)(),(0,i.iD)("img",{key:0,src:T.product.imgUrl,class:"d-block w-100",alt:"主圖",style:{height:"500px","object-fit":"cover"}},null,8,d)),(0,i._)("div",b,[(0,i._)("div",m,[(0,i._)("article",v,[(0,i._)("div",y,[(0,i._)("h2",_,(0,a.zw)(T.product.title),1),(0,i._)("button",{type:"button",class:(0,a.C_)(["btn btn-outline-primary rounded-circle fs-4 fav-btn",{active:T.favoriteIdList.includes(T.product.id)}]),onClick:s[0]||(s[0]=(0,c.iM)((t=>E.toggleFavorite(T.product)),["prevent","stop"]))},f,2)]),(0,i._)("small",k,[x,(0,i.Uk)(" "+(0,a.zw)(T.product.location),1)]),(0,i._)("div",C,(0,a.zw)(T.product.description),1),(0,i._)("div",I,(0,a.zw)(T.product.content),1),D,L]),(0,i._)("div",M,[(0,i._)("div",z,[(0,i._)("div",$,[T.product.price===T.product.origin_price?((0,i.wg)(),(0,i.iD)("h3",q,[(0,i.Uk)(" TWD "),(0,i._)("span",U,(0,a.zw)(t.$filters.currency(T.product.origin_price)),1),(0,i.Uk)(" 元 ")])):(0,i.kq)("",!0),T.product.price!==T.product.origin_price?((0,i.wg)(),(0,i.iD)("del",S," 原價 "+(0,a.zw)(t.$filters.currency(T.product.origin_price))+" 元 ",1)):(0,i.kq)("",!0),T.product.price!==T.product.origin_price?((0,i.wg)(),(0,i.iD)("h3",j,[(0,i.Uk)(" TWD"),(0,i._)("span",P,(0,a.zw)(t.$filters.currency(T.product.price)),1),(0,i.Uk)(" 元 ")])):(0,i.kq)("",!0),F,(0,i._)("div",W,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(T.product.date,(t=>((0,i.wg)(),(0,i.iD)("div",{class:"col-12",key:t},[(0,i._)("button",{type:"button",class:(0,a.C_)(["btn btn-outline-secondary h-100 w-100 rounded-0 border-0",{active:T.dateChosen===t}]),onClick:s=>T.dateChosen=t},(0,a.zw)(t),11,H)])))),128)),(0,i._)("div",Y,[Z,(0,i._)("div",K,[(0,i.wy)((0,i._)("input",{type:"number",class:"form-control",min:"1","aria-describedby":"number",id:"product_qty","onUpdate:modelValue":s[1]||(s[1]=t=>T.product.qty=t)},null,512),[[c.nr,T.product.qty]]),(0,i._)("span",N,"/ "+(0,a.zw)(T.product.unit),1)])]),(0,i._)("div",O,[T.addCartId!==T.product.id&&T.status.loadingItemId!==T.product.id?((0,i.wg)(),(0,i.iD)("button",{key:0,type:"button",class:"btn btn-outline-danger w-100 link-hover-white",onClick:s[2]||(s[2]=(0,c.iM)((t=>E.addCart(T.product.id,T.dateChosen,T.product.qty)),["prevent"])),disabled:T.addCartId===T.product.id},V,8,J)):T.status.loadingItemId===T.product.id?((0,i.wg)(),(0,i.iD)("button",A,G)):((0,i.wg)(),(0,i.iD)("button",{key:2,type:"button",class:"btn btn-outline-secondary w-100",onClick:s[3]||(s[3]=(0,c.iM)(((...s)=>t.goCart&&t.goCart(...s)),["prevent"]))},[(0,i.Wm)(nt,{to:"/cart/products",class:"link-primary link-hover-white text-decoration-none"},{default:(0,i.w5)((()=>[Q,R])),_:1})]))])])])])])])]),T.productsCatch?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",X,[(0,i._)("div",tt,[st,(0,i._)("div",et,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(E.similarProducts,(t=>((0,i.wg)(),(0,i.iD)("div",{class:"col",key:t.id},[(0,i._)("div",it,[(0,i._)("div",{style:(0,a.j5)([{"background-image":`url(${t.imgUrl})`},{height:"150px"}]),class:"bg-style rounded-top"},null,4),(0,i._)("div",at,[(0,i._)("div",ct,[(0,i._)("h5",ot,(0,a.zw)(t.title),1),(0,i._)("small",rt,[dt,(0,i.Uk)(" "+(0,a.zw)(t.location),1)]),(0,i._)("p",lt,(0,a.zw)(t.description),1)]),(0,i.Wm)(nt,{to:`/product/${t.id}`,class:"btn btn-outline-primary w-100",onClick:s=>E.getDetail(t.id)},{default:(0,i.w5)((()=>[(0,i.Uk)(" 詳細行程 ")])),_:2},1032,["to","onClick"])])])])))),128))])])]))]))],64)}e(7658);var ut=e(4226),pt={data(){return{isLoading:!1,id:"",dateChosen:"",product:{},products:[],addCartId:"",status:{loadingItemId:""},favoriteIdList:ut.Z.getFavorite()||[],productCatch:!1,productCatchMsg:"",productsCatch:!1}},inject:["pushMsgState","emitter"],methods:{getProduct(){const t=`https://vue3-course-api.hexschool.io/api/7rong-api/product/${this.id}`;this.isLoading=!0,this.$http.get(t).then((t=>{this.isLoading=!1,t.data.success&&(this.product=t.data.product,this.product.qty=1)})).catch((t=>{this.isLoading=!1,this.productCatch=!0,this.productCatchMsg=t.response.data.message}))},addCart(t,s,e=1){const i="https://vue3-course-api.hexschool.io/api/7rong-api/cart",a={product_id:t,qty:e,dateChosen:s};s?(this.status.loadingItemId=t,this.$http.post(i,{data:a}).then((s=>{this.status.loadingItemId="",this.addCartId=t,this.emitter.emit("update-cart",t);const e=s;e.content=`將「${this.product.title}」加入購物車`,this.pushMsgState(e,"加入")})).catch((t=>{const s={data:{}};s.data.success=t.response.data.success,s.data.message="系統錯誤，請稍後再試",this.pushMsgState(s,"加入")}))):this.pushMsgState({data:{success:!1,message:["請選擇日期"]}},"加入購物車")},getProducts(){const t="https://vue3-course-api.hexschool.io/api/7rong-api/products/all";this.$http.get(t).then((t=>{t.data.success&&(this.products=t.data.products)})).catch((t=>{this.productsCatch=!t.response.data.success}))},getDetail(t){this.dateChosen="",this.id=t,this.getProduct()},toggleFavorite(t){this.favoriteIdList.includes(t.id)?(this.favoriteIdList.splice(this.favoriteIdList.indexOf(t.id),1),this.pushMsgState({data:{success:!0},content:`將「${this.product.title}」移除我的最愛`},"移除")):(this.favoriteIdList.push(t.id),this.pushMsgState({data:{success:!0},content:`將「${this.product.title}」加入我的最愛`},"加入")),ut.Z.setFavorite(this.favoriteIdList),this.emitter.emit("update-favorite")}},computed:{similarProducts(){let t=this.products.filter((t=>t.category.match(this.product.category)&&t.id!==this.id));const s=[];if(t>3){for(let e=0;e<3;e+=1){const e=Math.floor(Math.random()*t.length),i=t[e];t.splice(e,1),s.push(i)}t=s}return t}},created(){this.id=this.$route.params.productId,this.getProduct(),this.getProducts(),this.status.loadingItemId=""}},ht=e(89);const gt=(0,ht.Z)(pt,[["render",nt]]);var bt=gt}}]);
//# sourceMappingURL=43.cc41c8ae.js.map